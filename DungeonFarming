^!d::  ; Control+Alt+d hotkey.
; Dungeon farming script. Repeats a single dungeon run until stopped.

CoordMode, Mouse, Window ; Set mouse environment

; Declarations 
dungeonPixelColor := 0x000000

if WinExist("Raid: Shadow Legends")
{
	WinActivate
		
	MouseMove, 15, 50
		
	; Begin Dungeon Run		
	if WinActive("Raid: Shadow Legends")
	{
		PixelGetColor, dungeonPixelColor, 3369, 1948
		
		if dungeonPixelColor = 0x0073B1
		{
			MouseClick, left, 3369, 1948
			sleep 1000
		}
}
	else
		Exit ; Terminate if Raid: Shadow Legends is not the active window
}
else
	Exit ; Terminate if Raid: Shadow Legends is not running

Loop
{
	dungeonPixelColor := 0x000000
	
	if WinExist("Raid: Shadow Legends")
	{
		WinActivate
		
		MouseMove, 15, 50
		
		; Continue dungeon run		
		if WinActive("Raid: Shadow Legends")
		{
			PixelGetColor, dungeonpixelColor, 2139, 1967
				
			if dungeonPixelColor = 0x947000
			{
				MsgBox, 4, , Continue running dungeon? Script will continue automatically after 5 seconds, 5 ; 5-second timeout
				IfMsgBox, No
				{
					MsgBox, Raid Dungeon Script stopped
					Exit ; Terminate on user selection
				}
				
				MouseClick, left, 2139, 1967
				Sleep 1000
			}
		}
		else
			Exit ; Terminate if Raid: Shadow Legends is not the active window
	}
	else
		Exit ; Terminate if Raid: Shadow Legends is not running
} 

return


^!g::  ; Control+Alt+g hotkey.
; Get current mouse position and pixel color.

CoordMode, Mouse, Window ; Set mouse environment

	; Declarations
	mousePosX := 0
	mousePosY := 0
	pixelColor := 0x000000

	MouseGetPos mousePosX, mousePosY
	PixelGetColor pixelColor, mousePosX, mousePosY

	MsgBox, The mouse position is %mousePosX%, %mousePosY%. `n The pixel color at that position is %pixelColor%.

return
	
; Useful coordinate and pixel color info

; Team Selection page
; Coords = 3369, 1948
; pixel color = 0x0073B1

; Rerun dungeon
; Coords = 2139, 1967
; pixel color = 0x8E6C00

; Check for auto run
; Coords = 192, 1933
; pixel color = 0xFFF371

